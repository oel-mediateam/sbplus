/*
 * Storybook Plus
 *
 * @author: Ethan Lin
 * @url: https://github.com/oel-mediateam/sbplus
 * @version: 2.8.2
 * Released 01/04/2018
 *
 * @license: GNU GENERAL PUBLIC LICENSE v3
 *
    Storybook Plus is an web application that serves multimedia contents.
    Copyright (C) 2013-2018  Ethan S. Lin, UWEX CEOEL Media Services

    This program is free software: you can redistribute it and/or modify
    it under the terms of the GNU General Public License as published by
    the Free Software Foundation, either version 3 of the License, or
    (at your option) any later version.

    This program is distributed in the hope that it will be useful,
    but WITHOUT ANY WARRANTY; without even the implied warranty of
    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
    GNU General Public License for more details.

    You should have received a copy of the GNU General Public License
    along with this program.  If not, see <http://www.gnu.org/licenses/>.
 *
 */
var topicCount=0,counter=0,previousIndex=0,tocIndex=0,tocClick=!1,noteArray,topicSrc,topicTitle,imgPath,slideImgFormat="png",accent="",media="Slide",version,imgCaption,questions,quizDetected=!1,PROFILE,lessonTitle,instructor,duration,mediaPlayer=null,isKaltura=!1,flavors={},kalturaLoaded=0,ROOT_PATH="https://media.uwex.edu/app/storybook_plus_v2/";$(document).ready(function(){$.fn.getLessonContent("assets/topic.xml")}),$.fn.getLessonContent=function(e){$.ajax({url:e,type:"GET",dataType:"xml",accepts:"xml",content:"xml",contentType:'xml; charset="utf-8"',cache:!1,encoding:"UTF-8",beforeSend:function(e){e.overrideMimeType("xml; charset=utf-8"),e.setRequestHeader("Accept","text/xml")},success:function(e){$.fn.parseContent(e)},error:function(e,t){$.fn.displayGetLessonError(e.status,t)}})},$.fn.parseContent=function(e){var t=$(e),s=t.find("setup"),i=t.find("topic"),n=$.fn.stripScript(s.find("lesson").text()),a=$.trim(s.find("instructor").text()),o=$.fn.stripScript(s.find("length").text()),r=$.fn.stripScript(s.find("slideImgFormat").text()),l=$.fn.stripScript(s.find("accent").text());PROFILE=$.fn.stripScript(t.find("profile").text()),lessonTitle="Lesson name is not specified.",instructor="Instructor name is not specified.",duration="",n.length&&(lessonTitle=n),a.length&&(instructor=a),o.length&&(duration=o),r.length&&(slideImgFormat=r.toLowerCase()),l.length&&(accent=l),topicSrc=[],topicTitle=[],noteArray=[],questions=[],i.each(function(){var e=$.trim($(this).attr("break")),s="";if(!e||"1"!==e&&"y"!==e&&"yes"!==e||(s="|"),topicTitle[topicCount]=$.trim($(this).attr("title")+s),topicSrc[topicCount]=$.trim($(this).attr("src")),noteArray[topicCount]=$.fn.stripScript($(this).find("note").text()),"quiz"===topicSrc[topicCount]){var i=t.find("topic:eq("+topicCount+")").find("quiz"),n=$.fn.stripScript(i.find("question").text()),a=$.trim(i.find("question").attr("img")),o=$.trim(i.find("question").attr("audio")),r=$.fn.stripScript(i.find("choice").text()),l=$.trim(i.find("choice").attr("useImg")),c=$.fn.stripScript(i.find("wrongFeedback").text()),d=$.fn.stripScript(i.find("correctFeedback").text()),u=$.trim(i.attr("type")),p=$.fn.stripScript(i.find("answer").text()),f={};f.id=topicCount,f.type=u,f.question=n,f.img=""!==a?a:"",f.audio=""!==o?o:"",f.choiceImg=""!==l?l:"",r?(f.choice=$.fn.splitSelections(r),f.wrongFeedback=$.fn.splitSelections(c)):f.wrongFeedback=c,f.answer=$.fn.splitSelections(p),f.stuAnswer="",f.correct=!1,f.correctFeedback=d,f.taken=!1,questions.push(f)}++topicCount}),questions.length&&(quizDetected=!0),$.fn.setupPlayer()},$.fn.setupPlayer=function(){var e;version=void 0===$("#storybook_plus_wrapper").attr("data-version")?"":$("#storybook_plus_wrapper").attr("data-version").replace(/\./g,""),$(document).attr("title",lessonTitle),$("#errorMsg").hide(),$.each(topicSrc,function(e){var t=topicSrc[e].substring(0,topicSrc[e].indexOf(":")+1);if("video:"!==t&&"youtube:"!==t&&"vimeo:"!==t&&"kaltura:"!==t)return media="Slide",!1;media="Video"}),(!0===quizDetected||version>=230)&&$("#storybook_plus_wrapper").addClass("withQuiz"),$("#selectable").before('<div id="toc_heading" class="toc_heading" aria-hidden="true" tabindex="-1">Table of Contents</div>'),$.each(topicTitle,function(t){var s="",i="";e="quiz"===topicSrc[t]?'<span class="icon-assessement light"><span class="sr-only">Self Assessement.</span></span> ':"",-1!==topicTitle[t].indexOf("|")&&(topicTitle[t]=topicTitle[t].replace("|",""),s=" sectionBreak"),i=e?'<li class="ui-widget-content'+s+'" title="'+$.fn.htmlEntities(topicTitle[t])+'"><div class="title"><span class="sr-only">'+media+' <span class="selectedNum">'+$.fn.addLeadingZero(t+1)+"</span> of "+topicCount+".</span> "+e+topicTitle[t]+"</div></li>":'<li class="ui-widget-content'+s+'" title="'+$.fn.htmlEntities(topicTitle[t])+'"><div class="title"><span class="sr-only">'+media+'</span> <span class="selectedNum">'+$.fn.addLeadingZero(t+1)+'</span><span class="sr-only">of '+topicCount+"</span>. "+topicTitle[t]+'<span class="sr-only">.</span></div></li>',$("#selectable").append(i)}),$("#splash_screen").css("background-image","url(assets/splash.jpg)"),$("#splash_screen").append('<p tabindex="1">'+lessonTitle+'</p><p tabindex="1">'+instructor+"</p>"+(0!==duration?'<p tabindex="1"><small>'+duration+"</small></p>":"")+'<a tabindex="1" role="button" class="playBtn" aria-label="Start Presentation" href="#">START</a>'),accent.length&&$(".playBtn").css("background-color",accent),$(".playBtn").on("click",function(){return $.fn.initializePlayer(),!1}),$.fn.getDownloadableFiles()},$.fn.initializePlayer=function(){$("#splash_screen").remove(),$("#lessonTitle").attr("title",lessonTitle),$("#lessonTitle").html(lessonTitle),$("#instructorName").html('<a class="instructorName" href="#" tabindex="-1">'+instructor+"</a>"),"Video"!==media&&$("#player").append('<div id="progressing"></div>'),$("#info, a.instructorName, #profileClose").on("click",function(){return $("#profile").is(":visible")?($("#profile").fadeOut("fast").attr("aria-expanded","false"),$("#info, a.instructorName, #profileClose").attr("aria-expanded","false")):($("#profile").fadeIn("fast").attr("aria-expanded","true"),$("#info, a.instructorName, #profileClose").attr("aria-expanded","true")),!1}),$("#selectable").selectable({appendTo:"#toc",autoRefresh:!1,selecting:function(e,t){$(".ui-selected, .ui-selecting").length>1&&$(t.selecting).removeClass("ui-selecting")},stop:function(){tocClick=!0,(tocIndex=Number($(".ui-selected .selectedNum").html())-1)!==previousIndex&&($.fn.loadSlide(topicSrc[tocIndex],tocIndex),previousIndex=tocIndex)}}),$("#leftBtn, .hidden-pre-btn").on("click",function(){return $.fn.previousSlide(),!1}),$("#rightBtn, .hidden-next-btn").on("click",function(){return $.fn.nextSlide(),!1}),(!0===quizDetected||version>=230)&&($("#control").append('<span tabindex="-1" id="magnifyBtn" aria-hidden="true"><span class="icon-expand" title="Expand"></span></span>'),$("#magnifyBtn").before('<span tabindex="-1" id="tocBtn" aria-hidden="true"><span class="toc" title="Toggle Table of Contents"></span></span>'),$("#magnifyBtn").before('<span tabindex="-1" id="notesBtn" aria-hidden="true"><span class="notes" title="Toggle Notes"></span></span>'),$.fn.bindImgMagnify(),$.fn.bindNoteSlideToggle(),$.fn.bindTocSlideToggle()),$.fn.loadProfilePhoto(),$("#profile .photo").before('<div class="profileCloseBtn"><a role="button" id="profileClose" href="#" aria-label="Close Profile" aria-controls="profile" aria-expanded="true" tabindex="1"><span aria-hidden="true">&times;</span></a></div>'),$("#profile .bio").html("<h2>"+instructor+"</h2>"+PROFILE),$.fn.loadSlide(topicSrc[0],counter),$.fn.keyboardEvents()},$.fn.previousSlide=function(){counter--,counter<0&&(counter=topicCount-1),$.fn.loadSlide(topicSrc[counter],counter),previousIndex=counter},$.fn.nextSlide=function(){counter++,counter>topicCount-1&&(counter=0),$.fn.loadSlide(topicSrc[counter],counter),previousIndex=counter},$.fn.loadSlide=function(e,t){var s,i=e.substring(e.indexOf(":")+1),n;switch("quiz"!==e&&(e=e.substring(0,e.indexOf(":")+1)),"video:"!==e&&"kaltura:"!==e&&"youtube:"!==e&&"vimeo:"!==e&&(n=setTimeout(function(){$("#progressing").fadeIn("fast")},3e3),i=i.toLowerCase()),$("#slideNote").hasClass("quizSlide")&&$("#slideNote").removeClass("quizSlide"),null!==mediaPlayer&&(mediaPlayer.dispose(),mediaPlayer=null,$("#vp").empty().hide(),$("#ap").empty().hide()),$("#slide").removeAttr("role").empty(),isKaltura=!1,e){case"image:":s=new Image,imgPath="assets/slides/"+i+"."+slideImgFormat,imgCaption=$("#selectable li .title").get(t).innerHTML,imgCaption=imgCaption.replace(imgCaption.slice(imgCaption.indexOf("<"),imgCaption.lastIndexOf(">")+1),""),$(s).load(function(){$(this).hide(),$("#slide").attr({role:"main",tabindex:1}).html('<div id="img"></div>'),$("#slide #img").html(s),$(this).fadeIn()}).error(function(){$.fn.displayErrorMsg("image not found!","Expected image: "+imgPath)}).attr({src:imgPath,alt:"Slide "+(t+1)+imgCaption,border:0});break;case"image-audio:":$.fn.setupMediaPlayer("audio",i);break;case"video:":$.fn.setupMediaPlayer("video",i);break;case"youtube:":$.fn.setupMediaPlayer("youtube",i);break;case"vimeo:":$.fn.setupMediaPlayer("vimeo",i);break;case"kaltura:":$.fn.setupMediaPlayer("kaltura",i),isKaltura=!0;break;case"swf:":$("#slide").html('<object width="640" height="360" type="application/x-shockwave-flash" data="assets/swf/'+i+'.swf"><param name="movie" value="assets/swf/'+i+'.swf" /><div id="errorMsg"><p>Error: Adobe Flash Player is not enabled or installed!</p><p>Adobe Flash Player is required to view this slide. Please enable or <a href="http://get.adobe.com/flashplayer/" target="_blank">install Adobe Flash Player</a>.</p></div></object>').promise().done(function(){});break;case"quiz":$("#slideNote").addClass("quizSlide"),$.fn.setupQuiz(t);break;default:$.fn.displayErrorMsg("Unknow slide type!","Please double check the XML file.");break}$(this).updateSlideNum(t),$(this).loadNote(t),clearTimeout(n)},$.fn.setupMediaPlayer=function(e,t){var s="",i="";switch(e){case"audio":s="apc",$.get("assets/slides/"+t+"."+slideImgFormat,function(){$.get("assets/audio/"+t+".vtt",function(){i='<track kind="subtitles" src="assets/audio/'+t+'.vtt" srclang="en" label="English">'}).always(function(){var e='<source src="assets/audio/'+t+'.mp3" type="audio/mp3">';$("#ap").html('<video id="'+s+'" class="video-js vjs-default-skin" poster="assets/slides/'+t+"."+slideImgFormat+'">'+e+i+"</video>").promise().done(function(){$.fn.loadVideoJsPlayer(s,t)})})}).fail(function(){$.fn.displayErrorMsg("Image not found!","Expected image: assets/slides/"+t+"."+slideImgFormat)});break;case"video":s="vpc",$.get("assets/video/"+t+".vtt",function(){i='<track kind="subtitles" src="assets/video/'+t+'.vtt" srclang="en" label="English">'}).always(function(){var e='<source src="assets/video/'+t+'.mp4" type="video/mp4">';$("#vp").html('<video id="'+s+'" class="video-js vjs-default-skin">'+e+i+"</video>").promise().done(function(){$.fn.loadVideoJsPlayer(s,t)})});break;case"kaltura":s="vpc",0===kalturaLoaded?$.getScript(ROOT_PATH+"/scripts/mwembedloader.js",function(){$.getScript(ROOT_PATH+"/scripts/kwidgetgetsources.js",function(){$.fn.requestKalturaAPI(s,t),kalturaLoaded=1})}):$.fn.requestKalturaAPI(s,t);break;case"youtube":s="ytb",$("#vp").html('<video id="'+s+'" class="video-js vjs-default-skin"></video>').promise().done(function(){$.fn.loadVideoJsPlayer(s,t)});break;case"vimeo":s="vm",$("#vp").html('<video id="'+s+'" class="video-js vjs-default-skin"></video>').promise().done(function(){$.fn.loadVideoJsPlayer(s,t)});break;default:$.fn.displayErrorMsg("Video error!","Please double check your XML file.");break}},$.fn.requestKalturaAPI=function(e,t){var s,i,n,a,o,r;kWidget.getSources({partnerId:1660872,entryId:t,callback:function(t){s=t.entryId,i=t.captionId,n=t.captionExt,a=t.captionLang,r=t.duration;for(var l in t.sources){var c=t.sources[l];487041===c.flavorParamsId&&(flavors.low=c.src),487081===c.flavorParamsId&&(flavors.normal=c.src),487061===c.flavorParamsId&&(flavors.high=c.src),487111===c.flavorParamsId&&(flavors.webm=c.src)}o='<video id="'+e+'" class="video-js vjs-default-skin" crossorigin="anonymous">',void 0!==flavors.webm&&$.fn.supportWebm()&&(o+='<source src="'+flavors.webm+'" type="video/webm" />'),null!==i&&(o+='<track kind="subtitles" src="https://www.kaltura.com/api_v3/?service=caption_captionasset&action=servewebvtt&captionAssetId='+i+"&segmentDuration="+r+'&segmentIndex=1" srclang="en" label="English">'),o+="</video>",$("#vp").html(o),$.fn.loadVideoJsPlayer(e)}})},$.fn.loadVideoJsPlayer=function(e,t){var s={techOrder:["html5","flash"],width:640,height:360,controls:!0,autoplay:!0,preload:"auto",playbackRates:[.5,1,1.5,2],plugins:{}};switch(e){case"vpc":!1===$.fn.supportMp4()&&!1===$.fn.supportWebm()&&(s.techOrder=["flash","html5"],s.plugins=null),isKaltura&&(s.plugins={videoJsResolutionSwitcher:{default:720}}),$("#vp").fadeIn();break;case"apc":s.poster="assets/slides/"+t+"."+slideImgFormat,s.plugins=null,$("#ap").fadeIn();break;case"ytb":s.techOrder=["youtube"],s.sources=[{type:"video/youtube",src:"https://www.youtube.com/watch?v="+t}],s.plugins={videoJsResolutionSwitcher:{default:720}},$("#vp").fadeIn();break;case"vm":s.techOrder=["vimeo"],s.sources=[{type:"video/vimeo",src:"https://vimeo.com/"+t}],s.plugins=null,$("#vp").fadeIn();break}mediaPlayer=videojs(e,s,function(){"vimeo"===s.techOrder[0]&&this.play(),isKaltura&&this.updateSrc([{src:flavors.low,type:"video/mp4",label:"low",res:"360"},{src:flavors.normal,type:"video/mp4",label:"normal",res:"720"},{src:flavors.high,type:"video/mp4",label:"high",res:"1080"}])}),videojs.options.flash.swf=ROOT_PATH+"videoplayer/video-js.swf"},$.fn.setupQuiz=function(e){for(var t=0,s=!1;!s||t>=questions.length;)questions[t].id===e?s=!0:t++;if($("#slide").html('<div id="quiz"><div class="header" aria-label="Self Assessment"><span class="icon-assessement"></span> Question for Self Assessment</div>'),questions[t].taken)$.fn.showFeedback(t);else if(""!==questions[t].img){var i=new Image;imgPath="assets/img/"+questions[t].img,$(i).load(function(){$("#quiz").append('<div id="quiz_quest" class="question">'+questions[t].question+"</div>"),$(".question").append(i);var e="";""!==questions[t].audio&&(e='<audio controls><source src="assets/audio/'+questions[t].audio+'.mp3" type="audio/mpeg" /></audio>',$("#quiz").append(e)),$.fn.displayAnswerChoices(t)}).error(function(){$.fn.displayErrorMsg("image not found!","Expected image: "+imgPath)}).attr({src:imgPath,alt:questions[t].question,border:0})}else{var n="";""!==questions[t].audio&&(n='<audio controls><source src="assets/audio/'+questions[t].audio+'.mp3" type="audio/mpeg" /></audio>'),$("#quiz").append('<div id="quiz_quest" class="question">'+questions[t].question+n+"</div>"),$.fn.displayAnswerChoices(t)}},$.fn.displayAnswerChoices=function(e){var t,s=!1;switch(questions[e].type){case"t/f":$("#quiz .header").append(": True or False"),$("#quiz").append('<div class="answerArea"><label for="t"><input role="radio" id="t" type="radio" name="tf" value="true" /> True</label><label for="f"><input role="radio" type="radio" id="f" name="tf" value="false" /> False</label></div>');break;case"fib":$("#quiz .header").append(": Fill In The Blank"),$("#quiz").append('<div class="answerArea"><input role="input" aria-required="true" type="text" aria-describedby="quiz_quest" id="saAns" /></div>');break;case"mc":var i="radio",n="mc";if(t=questions[e].answer.length,t>1?(i="checkbox",n="ma",$("#quiz .header").append(": Multiple Answers")):$("#quiz .header").append(": Multiple Choices"),$("#quiz").append('<div class="answerArea">'),"true"===questions[e].choiceImg)for(var a=0;a<questions[e].choice.length;a++)$(".answerArea").append('<label class="img_choice" for="'+a+'"><input role="'+i+'" id="'+a+'" type="'+i+'" name="'+n+'" value="'+$.fn.htmlEntities(questions[e].choice[a])+'" /> <img src="assets/img/'+questions[e].choice[a]+'" /></label>');else for(var o=0;o<questions[e].choice.length;o++)$(".answerArea").append('<label for="'+o+'"><input role="'+i+'" id="'+o+'" type="'+i+'" name="'+n+'" value="'+$.fn.htmlEntities(questions[e].choice[o])+'" /> '+questions[e].choice[o]+"</label>");$("#quiz").append("</div>");break;case"sa":$("#quiz .header").append(": Short Answer"),$("#quiz").append('<div class="answerArea"><textarea role="textbox" aria-describedby="quiz_quest" aria-multiline="true" aria-required="true" id="saAns"></textArea></div>');break;default:s=!0,$.fn.displayErrorMsg("unknow question type!","Please double check the topic XML file.");break}s||($("#quiz").append('<div class="submitArea"><a role="button" id="check" rel="'+e+'" href="#">SUBMIT</a></div><div class="sr-only">. Please navigate to the self assessment area to answer the question.</div>'),$("#slide").append("</div>"),$("#check").on("click",function(){var e=Number($(this).attr("rel")),s;switch(questions[e].type){case"t/f":s=$("input:radio[name=tf]:checked").val(),void 0===s&&(s="");break;case"fib":s=$.trim($("#saAns").val());break;case"mc":t>1?(s=[],$("input:checkbox[name=ma]:checked").each(function(){s.push($(this).val())}),questions[e].incorrectIndex=0):(s=$("input:radio[name=mc]:checked").val(),questions[e].incorrectIndex=$("input:radio[name=mc]").index($("input:radio[name=mc]").filter(":checked"))),(void 0===s||s.length<=0)&&(s="");break;case"sa":s=$.trim($("#saAns").val());break;default:s="";break}if(""!==s){switch(questions[e].type){case"fib":for(var i=0;i<questions[e].answer.length;i++)if(s.toLowerCase()===questions[e].answer[i].toLowerCase()){questions[e].correct=!0;break}break;case"t/f":s===String(questions[e].answer)?questions[e].correct=!0:questions[e].correct=!1;break;case"mc":var n=0;if(t>1){for(n=0;n<s.length;n++){if(!($.inArray(s[n],questions[e].answer)>=0)){questions[e].correct=!1;break}questions[e].correct=!0}n<questions[e].answer.length&&(questions[e].correct=!1)}else{var a=$.fn.htmlEntities(s),o=$.fn.htmlEntities(questions[e].answer[0]);questions[e].correct=a===o}break;default:questions[e].correct=!1;break}questions[e].stuAnswer=s,questions[e].taken=!0,$.fn.showFeedback(e)}else $(".question").before('<p class="quizIncorrect"><span class="icon-notification"></span> Please answer the question before submitting!</p>'),$(".quizIncorrect").delay(6e3).slideUp("slow",function(){$(".question").prev().remove()});return!1}))},$.fn.showFeedback=function(e){var t="",s="";if($("#slide").html('<div id="quiz"><div aria-label="Self Assessment Feedback" class="header"><span class="icon-assessement"></span> Feedback for Self Assessment</div>'),"sa"!==questions[e].type&&(questions[e].correct?$("#quiz").append('<p class="quizCorrect"><span class="icon-checkmark"></span> CORRECT</p>'):$("#quiz").append('<p class="quizIncorrect"><span class="icon-notification"></span> INCORRECT</p>')),""!==questions[e].img&&(t='<img aria-hidden="true" src="assets/img/'+questions[e].img+'" alt="'+questions[e].question+'" border="0" />'),""!==questions[e].audio&&(s='<audio controls aria-hidden="true"><source src="assets/audio/'+questions[e].audio+'.mp3" type="audio/mpeg" /></audio>'),$("#quiz").append('<div class="question" aria-hidden="true">'+questions[e].question+t+s+"</div>"),"true"===questions[e].choiceImg?($("#quiz").append('<div class="result"><p><strong>Your answer</strong>:<br />'+$.fn.parseArrayImg(questions[e].stuAnswer)+"</p></div>"),$(".result").append("<p><strong>Correct answer</strong>:<br />"+$.fn.parseArrayImg(questions[e].answer)+"</p>")):($("#quiz").append('<div class="result"><p><strong>Your answer</strong>:<br />'+$.fn.parseArray(questions[e].stuAnswer)+"</p></div>"),$(".result").append("<p><strong>Correct answer</strong>:<br />"+$.fn.parseArray(questions[e].answer)+"</p>")),"sa"!==questions[e].type)if(questions[e].correct)""!==String(questions[e].correctFeedback)&&$(".result").append("<p><strong>Feedback:</strong><br />"+questions[e].correctFeedback+"</p>");else if("mc"===questions[e].type){var i=questions[e].wrongFeedback[questions[e].incorrectIndex];void 0===i&&(i=questions[e].wrongFeedback),""!==String(i)&&$(".result").append("<p><strong>Feedback:</strong><br />"+i+"</p>")}else""!==String(questions[e].wrongFeedback)&&$(".result").append("<p><strong>Feedback:</strong><br />"+questions[e].wrongFeedback+"</p>")},$.fn.loadNote=function(e){var t=noteArray[e];t.length?($("#note").removeClass("noNotes").removeAttr("aria-hidden").attr({tabindex:1,role:"complementary","aria-label":"Notes"}).html(t).hide().fadeIn("fast"),$("#currentSlide").append(" This "+media.toLowerCase()+" contains notes."),$("#note").find("a").length&&$("#note a").each(function(){$(this).attr("target","_blank")})):($("#note").addClass("noNotes").removeAttr("role").removeAttr("aria-label").attr({tabindex:-1,"aria-hidden":!0}),$.fn.getProgramLogo()),$.fn.displayNotesBtn()},$.fn.displayNotesBtn=function(){$("#storybook_plus_wrapper").hasClass("magnified")&&($("#note").hasClass("noNotes")?($("#currentStatus").addClass("extendStatusWidth"),$("#notesBtn").fadeOut(0)):($("#currentStatus").removeClass("extendStatusWidth"),$("#notesBtn").fadeIn(0)))},$.fn.getProgramLogo=function(){var e=$.fn.getProgramDirectory(),t="uw_ex_ceoel_logo",s="University of Wisconsin-Extension Division of Continuing Education, Outreach &amp; E-Learning",i="";switch(e){case"smgt":case"msmgt":t="uw_smgt_logo",s="University of Wisconsin Sustainable Management";break;case"hwm":t="uw_hwm_logo",s="University of Wisconsin Health &amp; Wellness Management";break;case"himt":t="uw_himt_logo",s="University of Wisconsin Health Information Management &amp; Technology";break;case"il":t="uw_il_logo",s="University of Wisconsin Independent Learning";break;case"flx":t="uw_flx_logo",s="University of Wisconsin Flexible Option";break;case"bps":t="uw_bps_logo",s="University of Wisconsin Bachelor of Professional Studies in Organization Leadership and Communication";break;case"ds":t="ds_logo",s="University of Wisconsin Data Science";break;case"learning_store":t="uls_logo",s="University Learning Store";break}i='<img src="'+ROOT_PATH+"img/"+t+'.svg" width="150" height="65" alt="'+s+'" border="0" />',$("#note").html('<div class="logo" tabindex="-1" aria-hidden="true">'+i+"</div>")},$.fn.updateSlideNum=function(e){var t=e+1,s=media+" "+t+" of "+topicCount;counter=e,$("#selectable").selectable("refresh").selectItem("#selectable > li:nth-child("+t+")"),$("#currentStatus").html("<span>"+s+"</span>"),$("#hasNote").empty(),$("#currentSlide").html("You are currently on "+media.toLowerCase()+" "+t+" of "+topicCount+". "+$(".ui-selected").attr("title")+"."),$(".ui-selected").autoscroll(),setTimeout(function(){null!==mediaPlayer?mediaPlayer.on("ended",function(){$.fn.setSRStatus(t,topicCount)}):$.fn.setSRStatus(t,topicCount)},3e3)},$.fn.setSRStatus=function(e,t){var s="This "+media.toLowerCase()+" contains notes. Please navigate to the notes area.",i="End of presentation. Next button will take you back to the first "+media+".";!1===$("#note").hasClass("noNotes")&&$("#hasNote").html(s),e===t?$("#endPresentation").html(i):$("#endPresentation").empty()},$.fn.bindImgMagnify=function(){$("#magnifyBtn").on("click",function(){$("#storybook_plus_wrapper").hasClass("magnified")?($("#storybook_plus_wrapper").removeClass("magnified"),$(this).html('<span class="icon-expand" title="Expand"></span>'),$("#notesBtn, #tocBtn").fadeOut(0),$("#toc").css("left","").show(),$("#tocBtn").hasClass("active")&&$("#tocBtn").removeClass("active")):($("#storybook_plus_wrapper").addClass("magnified"),$(this).html('<span class="icon-contract" title="Contract"></span>'),$("#tocBtn").fadeIn(0),$("#currentStatus").addClass("extendStatusWidth"),$("#toc").hide()),$.fn.displayNotesBtn()})},$.fn.bindNoteSlideToggle=function(){var e=$("#note"),t=360,s=536;$("#notesBtn").on("click",function(){var t=Math.ceil(e.offset().top),s=0;t>=536?(s=360,$(this).addClass("active")):(s=536,$(this).removeClass("active")),$("#toc").offset().left<=642&&($("#toc").animate({left:900}),$("#tocBtn").removeClass("active")),e.animate({top:s})})},$.fn.bindTocSlideToggle=function(){var e=$("#toc"),t=642,s=900;$("#tocBtn").on("click",function(){$("#toc").show();var t=Math.ceil(e.offset().left),s=0;t>=900?(s=642,$(this).addClass("active")):(s=900,$(this).removeClass("active")),$("#note").offset().top>=360&&($("#note").animate({top:536}),$("#notesBtn").removeClass("active")),e.animate({left:s},function(){s>=900&&$("#toc").hide()})})},$.fn.loadProfilePhoto=function(){var e=new Image,t="assets/pic.jpg";$(e).load(function(){$("#profile .photo").html('<img src="'+t+'" border="0" alt="An photo of the instructor" />')}).error(function(){$("#profile .photo").html('<img src="'+ROOT_PATH+'img/profile.png" width="200" height="300" alt="No instructor photo" border="0" />')}).attr({src:t,border:0})},$.fn.getDownloadableFiles=function(){var e=$.fn.getDirectory(),t=$("#download_bar"),s=window.location.href,i="";s=s.substr(0,s.lastIndexOf("/")+1)+e,t.html("Loading downloadable items..."),$.get(s+".pdf",function(){i+='<div class="download_item"><a role="button" download href="'+s+'.pdf" target="_blank" tabindex="1"><span class="icon-arrow-down"><span><span class="sr-only">Download</span> Transcript <span class="sr-only">file</span></a></div>'}).always(function(){$.get(s+".mp3",function(){i+='<div class="download_item"><a role="button" download href="'+s+'.mp3" target="_blank" tabindex="1"><span class="icon-arrow-down"><span><span class="sr-only">Download</span> Audio <span class="sr-only">file</span></a></div>'}).always(function(){$.get(s+".zip",function(){i+='<div class="download_item"><a role="button" download href="'+s+'.zip" target="_blank" tabindex="1"><span class="icon-arrow-down"><span><span class="sr-only">Download</span> Supplement <span class="sr-only">file</span></a></div>'}).always(function(){t.html(i).hide().fadeIn(1e3)})})})},$.fn.displayGetLessonError=function(e,t){var s,i;switch(e){case 0:s="<strong>Error 0</strong> - Not connect. Please verify network.";break;case 200:s="<strong>Error 200</strong> - Invalid characters in XML.";break;case 404:s="<strong>Error 404</strong> - Requested page not found.";break;case 406:s="<strong>Error 406</strong> - Not acceptable error.";break;case 500:s="<strong>Error 500</strong> - Internal Server Error.";break;default:s="Unknow error ... "+e;break}switch(t){case"parsererror":i="XML parse failed. Please double-check the <strong>topic.xml</strong> file in the <strong>assets</strong> directory. All node values must be wrapped inside <code>&lt;![CDATA[ ... ]]&gt;</code> or use HTML entity for special characters.";break;case"timeout":i="XML parsing timed out. It is taking too long for the browser.";break;case"abort":i="Ajax request aborted.";break;case"error":i="Failed to get requested source. Most likely a 404 or 406.";break;default:i="Uncaught Error ... "+e.responseText;break}$("#splash_screen, #player").hide(),$("#errorMsg").html("<p>"+s+"</p><p>"+i+"</p>")},$.fn.splitSelections=function(e){return e.split("|")},$.fn.displayErrorMsg=function(e,t){$("#slide").html('<div id="errorMsg"><p><strong>Error:</strong> '+e+"</p><p>"+t+"</p></div>")},$.fn.getDirectory=function(){var e=window.location.href,t;return t=e.split("?"),t=t[0].split("/"),t=t[t.length-2]},$.fn.addLeadingZero=function(e){return e<10?"0"+e:e},$.fn.parseArray=function(e){var t="";if($.isArray(e))for(var s=0;s<e.length;s++)1===e.length?t+=e[0]:s===e.length-1?t+=e[s]:t+=e[s]+", ";else t=e;return t},$.fn.parseArrayImg=function(e){var t="";if($.isArray(e))for(var s=0;s<e.length;s++)t+='<img src="assets/img/'+e[s]+'" /> ';else t='<img src="assets/img/'+e+'" /> ';return t},$.fn.stripScript=function(e){if(""!==e||void 0!==e){var t=$("<span>"+$.trim(e)+"</span>");return t.find("script,noscript,style").remove().end(),t.html()}return e},$.fn.supportWebm=function(){return!!document.createElement("video").canPlayType('video/webm; codecs="vp8.0, vorbis"')},$.fn.supportMp4=function(){return!!document.createElement("video").canPlayType('video/mp4; codecs="avc1.4D401E, mp4a.40.2"')},$.fn.getProgramDirectory=function(){var e=window.location.href.split("/");return void 0===e[4]?"":e[4]},$.fn.autoscroll=function(){var e=Math.floor($(this).position().top);(e<32||e>=488)&&$("#selectable").scrollTo($(this),{duration:500,offsetTop:$("#selectable")[0].clientHeight/2+$(this).height()})},$.fn.scrollTo=function(e,t,s){"function"==typeof t&&2===arguments.length&&(s=t,t=e);var i=$.extend({scrollTarget:e,offsetTop:50,duration:500,easing:"swing"},t);return this.each(function(){var e=$(this),t="number"==typeof i.scrollTarget?i.scrollTarget:$(i.scrollTarget),n="number"==typeof t?t:t.offset().top+e.scrollTop()-parseInt(i.offsetTop);e.animate({scrollTop:n},parseInt(i.duration),i.easing,function(){"function"==typeof s&&s.call(this)})})},$.fn.selectItem=function(e){tocClick?tocClick=!1:($(".ui-selected",this).not(e).removeClass("ui-selected").addClass("ui-unselecting"),$(e).not(".ui-selected").addClass("ui-selected"))},$.fn.htmlEntities=function(e){return String(e).replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")},$.fn.keyboardEvents=function(){$(document).keydown(function(e){if(null!==mediaPlayer)switch(e.which){case 32:mediaPlayer.paused()?mediaPlayer.play():mediaPlayer.pause(),e.preventDefault();break}})};